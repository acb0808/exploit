# blobby blob
## 개요
문제에서 손상된 blob rsa 비밀키 파일을 준다. 이를 이용해서 암호문을 복호화하자.

## 풀이
아래 링크를 들어가보면 파일 구조에 대한 설명이 나와있고, 0x14 바이트까지 헤더 부분, 0x14바이트 부터 본문 부분임을 확인할 수 있다.

파일에서 N, p, q, d가 주어지는데 N의 크기를 k 바이트라 하면 p, q의 크기는 k/2바이트, d의 크기는 k 바이트로 총 3k 바이트이다.

0x14부터 주어진 파일 끝까지 총 길이가 0x300 바이트임을 알 수 있고 3등분을 하면 N, p를 온전하게 구해 낼 수 있다.

이후 N을 소인수분해 하고 RSA를 돌리면 풀린다.

_ex.py_
```py
from Crypto.Util.number import *

n = "8D 90 E3 33 BF 81 6D 33 F8 DC 0D 3F 77 AB F4 7F A2 B8 7E 84 32 7D E0 A8 3B B9 25 EC A5 3D 6E 57 04 53 7E 71 E7 3A 1A 0C 87 A7 78 9B 15 12 74 CE 83 66 15 59 73 6A 4B 3E 29 83 9D D7 94 CF A0 0C 11 9F 9E 11 0A B2 94 EF BC AB 73 07 39 4A A7 88 91 B2 82 94 BE E7 81 2F ED FF EA F1 04 45 3E 98 FB A9 CB 5E BE 35 E7 B2 46 6E F1 15 D6 1F E1 1A EE 59 65 C0 A2 FC 5A 6F 11 C8 13 C8 6C 67 4D 64 67 68 98 CF 65 2C 9D 1D 0E 47 FE 22 41 71 CC 1C CB 5B 28 35 AF DB 78 B1 F9 C0 C6 11 27 3F 6C 0E F7 17 C8 C7 AB 46 A6 85 AC 7F 1A B1 FA B6 36 0B E0 28 4F 1A E0 F0 25 56 64 F4 F7 13 DD E6 6D E4 33 01 E3 E1 E0 55 B0 67 C2 DF F9 9A B6 95 6B F9 29 E8 54 24 8C A6 D1 4A FA 8F 24 7B 99 2C BF F4 82 88 DD E8 3C 19 D6 E3 FB 05 FE 4B 03 51 6A 7E 21 B3 4B E9 BF 1C 35 42 E0 BE 18 38 56 97 DA A5".split(' ')
p = "23 E0 52 4B B2 5A FD B8 33 B5 16 0E AC DD 4C 67 E7 22 C8 F0 14 92 16 41 A2 88 8C C1 AE 96 55 11 AF 63 E8 B3 D8 27 CD D3 3D F3 E7 CC 89 6D 81 4E B0 D8 B0 EB B5 ED 1A 07 43 9B EA 62 1C 84 04 FE AF 95 CC 95 EE 58 D5 43 43 80 32 1B EF 37 D2 DC 5D 01 61 00 CA A3 34 32 2B A9 43 5E 12 62 29 91 50 F9 F7 F6 C9 56 5C E1 2E 5C 0F 54 AA CA E9 D5 A0 99 B7 79 FC EA 3C 72 F6 48 CF EB A4 9E 2E D8".split(' ')

n = [int(x, 16) for x in n]
p = [int(x, 16) for x in p]

n = int(bytes(n[::-1]).hex(), 16)
p = int(bytes(p[::-1]).hex(), 16)

assert n % p == 0

q = n // p

e = 0x10001

phi = (p - 1) * (q - 1)
d = inverse(e, phi)

ct = int("0x637237dc569b8f5028139b551b7d9b9ebb282e4c057edccebb47de219d5251c2a9b29bfb5325e37db9ff9056742a31e5dd286b441047675260e53d8549344b3c25c0bb9adffffd49f35236a384464bf5fa794b527fac2928e812a77fb4f10f231dfeab8b0a42dd59f9a6ab0ceae4c46e13227a196982c7c5202dd317a31895aa89a35fde5307432919e8339a213abd2a9b221d9d26154bb0576c77b6d10afd289c8a5f728b4e1d3ab4cf8ab74b15ae1e6bd423f1af65ad29deda565f2bb0b3330105edbe2fc21950d1757a27054e53b42395ee438ede97081c0cbed7211d9814648e6a24661f1915bd98bd5e92758310d8ffaefaf5a570864826574dca4c2b12", 16)

pt = pow(ct, d, n)

print(long_to_bytes(pt))
```
![alt](./res/2EZPHMO.png)
☑ cce2024{345Y_RSA_D3crYptI0n_U5ing_K3y_Bl0b}

# Ref
[https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-wcce/5cf2e6b9-3195-4f85-bc18-05b50e6d4e11](https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-wcce/5cf2e6b9-3195-4f85-bc18-05b50e6d4e11)